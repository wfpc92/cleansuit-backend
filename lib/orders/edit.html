<div class="row">
  <div class="col-lg-12">
    <div class="page-header">
      <ma-view-actions entry="entry" entity="::formController.entity">
        <ma-list-button entity="::entity"></ma-list-button>
        <ma-delete-button entry="entry" entity="::entity"></ma-delete-button>
      </ma-view-actions>
      <h1>Orden #{{ ::entry.values.codigo }} ({{ ::entry.values.estado | estado }})</h1>
    </div>
  </div>
</div>

<div class="row ng-admin-entity-ordenes" id="edit-view">
  <form class="col-md-12 form-horizontal" name="formController.form" ng-submit="formController.submitEdition($event)">

    <div class="row">
      <div class="col-md-6">
        <div class="order-box">

          <div ng-repeat="field in [
            formController.fields[1],
            formController.fields[8].editable(entry.values.estado == 'nueva'),
            formController.fields[11].editable(entry.values.estado == 'nueva')
          ] track by $index"
          compile="::field.getTemplateValueWithLabel(entry)">
            <!-- 1: Cliente -->
            <!-- 8: Teléfono -->
            <!-- 11: Cupon -->
            <ma-field field="::field" value="entry.values[field.name()]" entry="entry" entity="::entity" form="formController.form" datastore="::formController.dataStore"></ma-field>
          </div>

        </div>
      </div>
      <div class="col-md-6">
        <div class="order-box">

          <div ng-repeat="field in [
            formController.fields[0],
            formController.fields[9].editable(entry.values.estado == 'nueva'),
            formController.fields[10].editable(entry.values.estado == 'nueva')
          ] track by $index"
          compile="::field.getTemplateValueWithLabel(entry)">
            <!-- 0: Fecha -->
            <!-- 9: Forma de Pago -->
            <!-- 10: Servicio Directo -->
            <ma-field field="::field" value="entry.values[field.name()]" entry="entry" entity="::entity" form="formController.form" datastore="::formController.dataStore"></ma-field>
          </div>

        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="order-box">

          <fieldset>
            <legend>Recolección</legend>

            <div ng-repeat="field in [
              formController.fields[2].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[3].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[4].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[12].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1)
            ] track by $index"
            compile="::field.getTemplateValueWithLabel(entry)">
              <!-- 2: Dirección -->
              <!-- 3: Fecha -->
              <!-- 4: Hora -->
              <!-- 12: Domiciliario Recoleccion -->
              <ma-field field="::field" value="entry.values[field.name()]" entry="entry" entity="::entity" form="formController.form" datastore="::formController.dataStore"></ma-field>
            </div>

          </fieldset>

        </div>
      </div>
      <div class="col-md-6">
        <div class="order-box">

          <fieldset>
            <legend>Entrega</legend>

            <div ng-repeat="field in [
              formController.fields[5].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[6].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[7].editable(['nueva', 'rutaRecoleccion'].indexOf(entry.values.estado) != -1),
              formController.fields[13].editable(['procesando', 'rutaEntrega'].indexOf(entry.values.estado) != -1)
            ] track by $index"
            compile="::field.getTemplateValueWithLabel(entry)">
              <!-- 5: Dirección -->
              <!-- 6: Fecha -->
              <!-- 7: Hora -->
              <!-- 13: Domiciliario Entrega -->
              <ma-field field="::field" value="entry.values[field.name()]" entry="entry" entity="::entity" form="formController.form" datastore="::formController.dataStore"></ma-field>
            </div>

          </fieldset>

        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="order-box">

          <fieldset>
            <legend>Items</legend>

          <div ng-repeat="field in [
            formController.fields[14],
            formController.fields[15]
          ] track by $index"
          compile="::field.getTemplateValueWithLabel(entry)">
            <!-- 14: Recoleccion -->
            <!-- 15: Items -->
            <ma-field field="::field" value="entry.values[field.name()]" entry="entry" entity="::entity" form="formController.form" datastore="::formController.dataStore"></ma-field>
          </div>

          </fieldset>

        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <button ng-if="['entregada', 'cancelada'].indexOf(entry.values.estado) == -1" type="submit" class="btn btn-primary"><span class="fa fa-save fa-fw"></span> Guardar Cambios</button>
        <order-status orden="entry" form="::formController.form"></order-status>
      </div>
    </div>

  </form>
</div>
